var e={954(){}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n=function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};function i(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})}function o(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}function a(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;for(var s={},c={},u=0;u<256;u++){var l=u.toString(16).toLowerCase();1===l.length&&(l="0".concat(l)),s[u]=l,c[l]=u}function f(e){for(var t="",r=0;r<e.byteLength;r++)t+=s[e[r]];return t}var h=function(e){if("function"==typeof e)return e;var t=Promise.resolve(e);return function(){return t}},g="X-Amz-Date",d="X-Amz-Signature",p="X-Amz-Security-Token",v="authorization",y=g.toLowerCase(),b=[v,y,"date"],w=d.toLowerCase(),S="x-amz-content-sha256",m=p.toLowerCase(),x={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},O=/^proxy-/,j=/^sec-/,A="AWS4-HMAC-SHA256",k="AWS4-HMAC-SHA256-PAYLOAD",C="aws4_request",P={},D=[],q=function(e,t,r){return"".concat(e,"/").concat(t,"/").concat(r,"/").concat(C)},E=function(e,t,r){var n=new e(t);return n.update(r),n.digest()},L=function(e,t,r){var n,i,o=e.headers,s={};try{for(var c=a(Object.keys(o).sort()),u=c.next();!u.done;u=c.next()){var l=u.value,f=l.toLowerCase();(f in x||(null==t?void 0:t.has(f))||O.test(f)||j.test(f))&&(!r||r&&!r.has(f))||(s[f]=o[l].trim().replace(/\s+/g," "))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}return s},R=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,H)},H=function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())},I=function(e,t){var r=e.headers,n=e.body;return i(void 0,void 0,void 0,function(){var e,i,s,c,u,l,h;return o(this,function(o){switch(o.label){case 0:try{for(e=a(Object.keys(r)),i=e.next();!i.done;i=e.next())if((s=i.value).toLowerCase()===S)return[2,r[s]]}catch(e){l={error:e}}finally{try{i&&!i.done&&(h=e.return)&&h.call(e)}finally{if(l)throw l.error}}return null!=n?[3,1]:[2,"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"];case 1:return"string"==typeof n||ArrayBuffer.isView(n)||(g=n,"function"==typeof ArrayBuffer&&g instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(g))?((c=new t).update(n),u=f,[4,c.digest()]):[3,3];case 2:return[2,u.apply(void 0,[o.sent()])];case 3:return[2,"UNSIGNED-PAYLOAD"]}var g})})},z=function(e){var t=e.headers,r=e.query,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(e,["headers","query"]);return n(n({},i),{headers:n({},t),query:r?T(r):void 0})},T=function(e){return Object.keys(e).reduce(function(t,r){var i,o=e[r];return n(n({},t),((i={})[r]=Array.isArray(o)?function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}([],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}(o),!1):o,i))},{})},K=function(e){var t,r;e="function"==typeof e.clone?e.clone():z(e);try{for(var n=a(Object.keys(e.headers)),i=n.next();!i.done;i=n.next()){var o=i.value;b.indexOf(o.toLowerCase())>-1&&delete e.headers[o]}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return e},X=function(){function e(e){var t=e.applyChecksum,r=e.credentials,n=e.region,i=e.service,o=e.sha256,a=e.uriEscapePath,s=void 0===a||a;this.service=i,this.sha256=o,this.uriEscapePath=s,this.applyChecksum="boolean"!=typeof t||t,this.regionProvider=h(n),this.credentialProvider=h(r)}return e.prototype.presign=function(e,t){return void 0===t&&(t={}),i(this,void 0,void 0,function(){var r,i,s,c,u,l,f,h,v,y,b,w,S,m,x,O,j,k,C,P,D,E,R,H;return o(this,function(o){switch(o.label){case 0:return r=t.signingDate,i=void 0===r?new Date:r,s=t.expiresIn,c=void 0===s?3600:s,u=t.unsignableHeaders,l=t.unhoistableHeaders,f=t.signableHeaders,h=t.signingRegion,v=t.signingService,[4,this.credentialProvider()];case 1:return y=o.sent(),null==h?[3,2]:(w=h,[3,4]);case 2:return[4,this.regionProvider()];case 3:w=o.sent(),o.label=4;case 4:return b=w,S=N(i),m=S.longDate,x=S.shortDate,c>604800?[2,Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future")]:(O=q(x,b,null!=v?v:this.service),j=function(e,t){var r,i,o;void 0===t&&(t={});var s="function"==typeof e.clone?e.clone():z(e),c=s.headers,u=s.query,l=void 0===u?{}:u;try{for(var f=a(Object.keys(c)),h=f.next();!h.done;h=f.next()){var g=h.value,d=g.toLowerCase();"x-amz-"!==d.slice(0,6)||(null===(o=t.unhoistableHeaders)||void 0===o?void 0:o.has(d))||(l[g]=c[g],delete c[g])}}catch(e){r={error:e}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}return n(n({},e),{headers:c,query:l})}(K(e),{unhoistableHeaders:l}),y.sessionToken&&(j.query[p]=y.sessionToken),j.query["X-Amz-Algorithm"]=A,j.query["X-Amz-Credential"]="".concat(y.accessKeyId,"/").concat(O),j.query[g]=m,j.query["X-Amz-Expires"]=c.toString(10),k=L(j,u,f),j.query["X-Amz-SignedHeaders"]=U(k),C=j.query,P=d,D=this.getSignature,E=[m,O,this.getSigningKey(y,b,x,v)],R=this.createCanonicalRequest,H=[j,k],[4,I(e,this.sha256)]);case 5:return[4,D.apply(this,E.concat([R.apply(this,H.concat([o.sent()]))]))];case 6:return C[P]=o.sent(),[2,j]}})})},e.prototype.sign=function(e,t){return i(this,void 0,void 0,function(){return o(this,function(r){return"string"==typeof e?[2,this.signString(e,t)]:e.headers&&e.payload?[2,this.signEvent(e,t)]:[2,this.signRequest(e,t)]})})},e.prototype.signEvent=function(e,t){var r=e.headers,n=e.payload,a=t.signingDate,s=void 0===a?new Date:a,c=t.priorSignature,u=t.signingRegion,l=t.signingService;return i(this,void 0,void 0,function(){var e,t,i,a,h,g,d,p,v,y,b;return o(this,function(o){switch(o.label){case 0:return null==u?[3,1]:(t=u,[3,3]);case 1:return[4,this.regionProvider()];case 2:t=o.sent(),o.label=3;case 3:return e=t,i=N(s),a=i.shortDate,h=i.longDate,g=q(a,e,null!=l?l:this.service),[4,I({headers:{},body:n},this.sha256)];case 4:return d=o.sent(),(p=new this.sha256).update(r),y=f,[4,p.digest()];case 5:return v=y.apply(void 0,[o.sent()]),b=[k,h,g,c,v,d].join("\n"),[2,this.signString(b,{signingDate:s,signingRegion:e,signingService:l})]}})})},e.prototype.signString=function(e,t){var r=void 0===t?{}:t,n=r.signingDate,a=void 0===n?new Date:n,s=r.signingRegion,c=r.signingService;return i(this,void 0,void 0,function(){var t,r,n,i,u,l,h,g;return o(this,function(o){switch(o.label){case 0:return[4,this.credentialProvider()];case 1:return t=o.sent(),null==s?[3,2]:(n=s,[3,4]);case 2:return[4,this.regionProvider()];case 3:n=o.sent(),o.label=4;case 4:return r=n,i=N(a).shortDate,h=(l=this.sha256).bind,[4,this.getSigningKey(t,r,i,c)];case 5:return(u=new(h.apply(l,[void 0,o.sent()]))).update(e),g=f,[4,u.digest()];case 6:return[2,g.apply(void 0,[o.sent()])]}})})},e.prototype.signRequest=function(e,t){var r=void 0===t?{}:t,n=r.signingDate,s=void 0===n?new Date:n,c=r.signableHeaders,u=r.unsignableHeaders,l=r.signingRegion,f=r.signingService;return i(this,void 0,void 0,function(){var t,r,n,i,h,g,d,p,b,w,x;return o(this,function(o){switch(o.label){case 0:return[4,this.credentialProvider()];case 1:return t=o.sent(),null==l?[3,2]:(n=l,[3,4]);case 2:return[4,this.regionProvider()];case 3:n=o.sent(),o.label=4;case 4:return r=n,i=K(e),h=N(s),g=h.longDate,d=h.shortDate,p=q(d,r,null!=f?f:this.service),i.headers[y]=g,t.sessionToken&&(i.headers[m]=t.sessionToken),[4,I(i,this.sha256)];case 5:return b=o.sent(),!function(e,t){var r,n;e=e.toLowerCase();try{for(var i=a(Object.keys(t)),o=i.next();!o.done;o=i.next())if(e===o.value.toLowerCase())return!0}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return!1}(S,i.headers)&&this.applyChecksum&&(i.headers[S]=b),w=L(i,u,c),[4,this.getSignature(g,p,this.getSigningKey(t,r,d,f),this.createCanonicalRequest(i,w,b))];case 6:return x=o.sent(),i.headers[v]="".concat(A," ")+"Credential=".concat(t.accessKeyId,"/").concat(p,", ")+"SignedHeaders=".concat(U(w),", ")+"Signature=".concat(x),[2,i]}})})},e.prototype.createCanonicalRequest=function(e,t,r){var n=Object.keys(t).sort();return"".concat(e.method,"\n").concat(this.getCanonicalPath(e),"\n").concat(function(e){var t,r,n=e.query,i=void 0===n?{}:n,o=[],s={},c=function(e){if(e.toLowerCase()===w)return"continue";o.push(e);var t=i[e];"string"==typeof t?s[e]="".concat(R(e),"=").concat(R(t)):Array.isArray(t)&&(s[e]=t.slice(0).sort().reduce(function(t,r){return t.concat(["".concat(R(e),"=").concat(R(r))])},[]).join("&"))};try{for(var u=a(Object.keys(i).sort()),l=u.next();!l.done;l=u.next())c(l.value)}catch(e){t={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}return o.map(function(e){return s[e]}).filter(function(e){return e}).join("&")}(e),"\n").concat(n.map(function(e){return"".concat(e,":").concat(t[e])}).join("\n"),"\n\n").concat(n.join(";"),"\n").concat(r)},e.prototype.createStringToSign=function(e,t,r){return i(this,void 0,void 0,function(){var n,i;return o(this,function(o){switch(o.label){case 0:return(n=new this.sha256).update(r),[4,n.digest()];case 1:return i=o.sent(),[2,"".concat(A,"\n").concat(e,"\n").concat(t,"\n").concat(f(i))]}})})},e.prototype.getCanonicalPath=function(e){var t,r,n=e.path;if(this.uriEscapePath){var i=[];try{for(var o=a(n.split("/")),s=o.next();!s.done;s=o.next()){var c=s.value;0!==(null==c?void 0:c.length)&&"."!==c&&(".."===c?i.pop():i.push(c))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}var u="".concat((null==n?void 0:n.startsWith("/"))?"/":"").concat(i.join("/")).concat(i.length>0&&(null==n?void 0:n.endsWith("/"))?"/":"");return encodeURIComponent(u).replace(/%2F/g,"/")}return n},e.prototype.getSignature=function(e,t,r,n){return i(this,void 0,void 0,function(){var i,a,s,c,u;return o(this,function(o){switch(o.label){case 0:return[4,this.createStringToSign(e,t,n)];case 1:return i=o.sent(),c=(s=this.sha256).bind,[4,r];case 2:return(a=new(c.apply(s,[void 0,o.sent()]))).update(i),u=f,[4,a.digest()];case 3:return[2,u.apply(void 0,[o.sent()])]}})})},e.prototype.getSigningKey=function(e,t,r,n){return function(e,t,r,n,s){return i(void 0,void 0,void 0,function(){var i,c,u,l,h,g,d,p,v;return o(this,function(o){switch(o.label){case 0:return[4,E(e,t.secretAccessKey,t.accessKeyId)];case 1:if(i=o.sent(),(c="".concat(r,":").concat(n,":").concat(s,":").concat(f(i),":").concat(t.sessionToken))in P)return[2,P[c]];for(D.push(c);D.length>50;)delete P[D.shift()];u="AWS4".concat(t.secretAccessKey),o.label=2;case 2:o.trys.push([2,7,8,9]),l=a([r,n,s,C]),h=l.next(),o.label=3;case 3:return h.done?[3,6]:(g=h.value,[4,E(e,u,g)]);case 4:u=o.sent(),o.label=5;case 5:return h=l.next(),[3,3];case 6:return[3,9];case 7:return d=o.sent(),p={error:d},[3,9];case 8:try{h&&!h.done&&(v=l.return)&&v.call(l)}finally{if(p)throw p.error}return[7];case 9:return[2,P[c]=u]}})})}(this.sha256,e,r,t,n||this.service)},e}(),N=function(e){var t,r=(t=e,function(e){return"number"==typeof e?new Date(1e3*e):"string"==typeof e?Number(e)?new Date(1e3*Number(e)):new Date(e):e}(t).toISOString().replace(/\.\d{3}Z$/,"Z")).replace(/[\-:]/g,"");return{longDate:r,shortDate:r.slice(0,8)}},U=function(e){return Object.keys(e).sort().join(";")},W=function(){function e(e){this.sigv4Signer=new X(e),this.signerOptions=e}return e.prototype.sign=function(e,t){return void 0===t&&(t={}),i(this,void 0,void 0,function(){return o(this,function(r){if("*"===t.signingRegion){if("node"!==this.signerOptions.runtime)throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return[2,this.getSigv4aSigner().sign(e,t)]}return[2,this.sigv4Signer.sign(e,t)]})})},e.prototype.presign=function(e,t){return void 0===t&&(t={}),i(this,void 0,void 0,function(){return o(this,function(r){if("*"===t.signingRegion){if("node"!==this.signerOptions.runtime)throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return[2,this.getSigv4aSigner().presign(e,t)]}return[2,this.sigv4Signer.presign(e,t)]})})},e.prototype.getSigv4aSigner=function(){if(!this.sigv4aSigner){var e;try{if("function"!=typeof(e=r(954).CrtSignerV4))throw new Error}catch(e){throw e.message="".concat(e.message,'\nPlease check if you have installed "@aws-sdk/signature-v4-crt" package explicitly. \n')+"For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt",e}this.sigv4aSigner=new e(n(n({},this.signerOptions),{signingAlgorithm:1}))}return this.sigv4aSigner},e}();export{W as SignatureV4MultiRegion};